## 📘 데이터 중심 애플리케이션 설계

### Chapter 2. 데이터 모델과 질의 언어

---

### 🧭 1. 한 줄 요약 

> 데이터 모델과 질의 언어는 저장 기술의 문제가 아니라, **애플리케이션의 사고 방식과 확장 전략을 결정하는 핵심 설계 선택**이다.

---

### 🗂 2. 전체 내용 정리

### 서론

데이터 모델은 단순한 저장 구조가 아니라, 문제를 어떻게 이해하고 소프트웨어를 어떻게 설계할지를 결정하는 사고의 틀이다.

대부분의 애플리케이션은 여러 데이터 모델을 계층적으로 쌓아 만들며, 각 계층의 핵심 과제는 상위 개념을 하위 계층이 이해할 수 있는 형태로 표현하는 것이다.

따라서 애플리케이션에 적합한 데이터 모델을 선택하는 일은 매우 중요하다.

---

### 관계형 모델과 문서 모델

관계형 데이터 모델은 1970년 에드가 코드가 제안했으며, SQL을 기반으로 데이터를 관계(순서 없는 튜플의 집합)로 표현한다.

1980년대 중반 이후 약 25~30년간 데이터베이스 분야의 표준으로 자리 잡았고, 오늘날에도 대부분의 웹 서비스는 여전히 관계형 데이터베이스를 사용한다.

---

### NoSQL의 탄생

NoSQL은 2010년대에 **관계형 데이터베이스의 한계를 보완하기 위해 등장**했으며, 확장성 요구, 오픈소스 선호, 관계형 모델로는 어려운 질의, 유연한 스키마에 대한 필요가 주요 배경이다.

앞으로는 하나의 시스템에서 관계형 DB와 NoSQL을 함께 사용하는 **다중 저장소 지속성**이 일반적인 방식이 될 것이다.

---

### 객체 관계형 불일치

대부분의 애플리케이션은 객체 지향 언어로 작성되며, 이로 인해 객체 모델과 관계형 모델 간의 불일치(임피던스 불일치)가 발생한다. ORM은 이를 완화하지만 완전히 제거하지는 못한다.

이력서처럼 구조가 유동적이고 중첩된 데이터는 다중 테이블보다 JSON 문서 모델이 더 자연스럽고, 하나의 질의로 전체를 읽을 수 있다는 장점이 있다.

다만 문서 모델은 질의, 제약, 표준화 측면에서 한계도 함께 가진다.

---

### 다대일·다대다 관계

공통으로 사용되는 값은 텍스트 대신 ID로 참조하면 중복을 제거하고 일관성과 갱신성을 확보할 수 있으며, 이는 정규화와 다대일 관계를 만든다.

관계형 데이터베이스는 조인을 통해 이를 쉽게 처리하지만, 문서 데이터베이스는 조인 지원이 약하다.

애플리케이션이 성장하며 데이터가 점점 상호 연결되면 다대다 관계가 필요해지고, 이 경우 관계형 모델이 더 적합해진다.

---

### 문서 데이터베이스는 역사를 반복하고 있나?

문서 데이터베이스와 NoSQL은 **다대다 관계와 조인을 어떻게 표현할 것인가**라는 오래된 문제를 다시 드러낸다.

이는 과거 계층 모델(IMS)이 가졌던 한계와 본질적으로 동일하며, 데이터 모델 선택의 문제는 시대를 넘어 반복된다.

---

### 네트워크 모델과 관계형 모델의 차이

네트워크 모델은 포인터 기반 접근으로 다대다 관계를 표현했지만, 질의와 유지보수가 매우 복잡했다.

관계형 모델은 접근 경로를 질의 최적화기에 위임함으로써 구조 변경과 최적화에 유리한 모델을 제공했다.

---

### 관계형 DB vs 문서 DB

문서 데이터베이스는 스키마 유연성과 지역성에 강점이 있고,

관계형 데이터베이스는 조인과 복잡한 관계 처리에 강점을 가진다.

---

### 어떤 데이터 모델이 코드를 더 단순하게 할까?

데이터 모델의 선택은 코드의 단순성 자체보다 **데이터의 관계 구조와 접근 패턴**에 의해 결정된다.

---

### 스키마 유연성과 데이터 지역성

문서 DB는 읽기 스키마로 유연성을 제공하고, 관계형 DB는 쓰기 스키마로 일관성을 보장한다.

문서 모델은 전체 문서를 자주 읽을 때 유리하지만, 큰 문서나 잦은 갱신에는 비효율적일 수 있다.

---

### 문서 DB와 관계형 DB의 통합

관계형 DB는 JSON·XML을, 문서 DB는 조인을 보완하며 두 모델은 점점 수렴하고 있다.

---

### 데이터를 위한 질의 언어

SQL 같은 선언형 질의 언어는 **무엇을 원하는지만 표현**하고, 실행 방식은 데이터베이스가 결정한다.

이는 최적화, 구조 변경, 병렬 처리에 매우 유리하다.

---

### 웹에서의 선언형 질의

CSS·XSL 같은 선언형 언어는 패턴만 선언하며, 브라우저가 자동으로 처리한다.

이는 데이터베이스에서 SQL이 명령형 API보다 유리한 이유와 동일하다.

---

### 맵리듀스 질의

맵리듀스는 분산 처리를 위한 모델이지만 명령형 방식이라 복잡하고 최적화에 불리하다.

이로 인해 NoSQL도 점차 선언형 집계 방식으로 발전하고 있다.

---

### 그래프형 데이터 모델

다대다 관계가 복잡해질수록 그래프 모델이 자연스럽다.

그래프는 서로 다른 유형의 객체와 관계를 하나의 저장소에서 일관되게 표현할 수 있다.

---

### 속성 그래프

속성 그래프는 정점과 간선 모두 속성을 가지며, 다양한 관계를 유연하게 표현하고 순회에 강하다.

---

### 사이퍼 질의 언어

사이퍼는 그래프 패턴을 직관적으로 표현하는 선언형 질의 언어로, 실행 전략은 데이터베이스가 선택한다.

---

### SQL의 그래프 질의

SQL로 그래프 질의는 가능하지만 재귀 CTE 등으로 복잡해진다.

그래프 전용 질의 언어는 가변 경로 순회를 훨씬 간결하게 표현한다.

---

### 트리플 저장소

트리플 저장소는 모든 데이터를 (주어, 서술어, 목적어)로 표현하는 단순한 그래프 모델이다.

---

### 스파클 질의 언어

스파클은 RDF 기반 그래프 질의 언어로, 속성과 관계를 동일한 패턴 매칭으로 다룬다.

---

### 데이터로그

데이터로그는 사실과 규칙을 반복 적용해 결과를 추론하는 규칙 기반 선언형 언어로, 재귀적 그래프 탐색에 강하다.

---

### ✍️ 3. 느낀 점 & 개인적 인사이트

이 장을 통해 데이터 모델과 질의 언어는 단순한 기술 선택이 아니라, 애플리케이션의 복잡도를 어디에서 감당할지 결정하는 설계자의 사고 방식이며, 앞으로는 기능 구현보다 먼저 데이터의 관계 구조와 질의 패턴을 의식적으로 설계해야겠다고 느꼈다